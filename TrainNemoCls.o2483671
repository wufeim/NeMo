Start time: Di 17. Jan 14:51:34 CET 2023
2023-01-17 14:52:06,168 - INFO - Namespace(cate='all', config='config/3d_aware_cls_nemo_cls.yaml', save_dir='exp/3d_aware_cls_nemo_cls', dry_run=False, opts=None)
2023-01-17 14:52:06,241 - INFO - 
================
Configurations
================
dataset:
  augment_by_dist: False
  class_name: nemo.datasets.pascal3d.Pascal3DPlus
  dtd_raw_path: /misc/lmbraid21/jesslen/NeMo/data/dtd
  enable_cache: True
  image_sizes:
    aeroplane:
    - 512
    - 512
    bicycle:
    - 512
    - 512
    boat:
    - 512
    - 512
    bottle:
    - 512
    - 512
    bus:
    - 512
    - 512
    car:
    - 512
    - 512
    chair:
    - 512
    - 512
    diningtable:
    - 512
    - 512
    motorbike:
    - 512
    - 512
    sofa:
    - 512
    - 512
    train:
    - 512
    - 512
    tvmonitor:
    - 512
    - 512
  image_subsets_url: https://docs.google.com/uc?export=download&id=1NsoVXW8ngQCqTHHFSW8YYsCim9EjiXS7
  mesh_path: /misc/lmbraid21/jesslen/NeMo/data/PASCAL3D+_release1.1/CAD_single
  name: pascal3d_cls
  occ_level: 0
  occ_levels:
    train:
    - 0
    val:
    - 0
    - 1
    - 2
    - 3
  pad_texture: False
  pascal3d_occ_raw_path: /misc/lmbraid21/jesslen/NeMo/data/OccludedPASCAL3D
  pascal3d_occ_script_url: https://raw.githubusercontent.com/Angtian/OccludedPASCAL3D/master/download_FG.sh
  pascal3d_raw_path: /misc/lmbraid21/jesslen/NeMo/data/PASCAL3D+_release1.1
  pascal3d_raw_url: ftp://cs.stanford.edu/cs/cvgl/PASCAL3D+_release1.1.zip
  prepare_mode: first
  remove_no_bg: 8
  root_path: /misc/lmbraid21/jesslen/NeMo/data/PASCAL3D_NeMo
  sampler: None
  seg_data_path: /misc/lmbraid21/jesslen/NeMo/data/PASCAL3D_segmentation
  seg_data_url: https://docs.google.com/uc?export=download&id=1hx6eErHtuR7TCGlQMyl2_03gXDTQw3Qm
  single_mesh: True
  subtypes: None
  training_only: False
  transforms:
  - class_name: nemo.datasets.pascal3d.ToTensor
  - class_name: nemo.datasets.pascal3d.Normalize
  weighted: True
inference:
  azim_sample:
    max_pi: 2.0
    min_pi: 0.0
    num: 12
  blur_radius: 0.0
  dist_sample:
    max: 6.0
    min: 4.0
    num: 3
  elev_sample:
    max_pi: 0.3333
    min_pi: -0.1667
    num: 4
  epochs: 300
  inter_mode: bilinear
  loss: nemo.models.solve_pose.loss_fg_bg
  min_distance: 2
  optimize_translation: False
  optimizer:
    betas:
    - 0.4
    - 0.6
    class_name: torch.optim.Adam
    lr: 0.05
  pre_rendering_thr: 80
  px_sample:
    max: 0.0
    min: 0.0
    num: 1
  py_sample:
    max: 0.0
    min: 0.0
    num: 1
  random_seed: 0
  scheduler:
    class_name: torch.optim.lr_scheduler.ExponentialLR
    gamma: 0.2
  search_translation: False
  theta_sample:
    max_pi: 0.1667
    min_pi: -0.1667
    num: 3
  translation_scale: 0.1
  visualize_num_samples: 0
model:
  backbone:
    class_name: nemo.models.keypoint_representation_net.NetE2E
    local_size:
    - 1
    - 1
    n_noise_points: 5
    net_type: resnetext
    noise_on_mask: False
    output_dimension: 128
    pretrain: True
    reduce_function: None
  class_name: nemo.models.nemo_cls.NeMoCls
  down_sample_rate: 8
  inference:
    cameras:
      class_name: pytorch3d.renderer.PerspectiveCameras
      focal_length: 3000
    raster_settings:
      bin_size: 0
      blur_radius: 0.0
      class_name: pytorch3d.renderer.RasterizationSettings
      faces_per_pixel: 1
    rasterizer:
      class_name: pytorch3d.renderer.MeshRasterizer
  max_group: 512
  memory_bank:
    K: 1
    class_name: nemo.models.feature_banks_cls.NearestMemoryManager
    input_size: 128
    momentum: 0.96
  mesh_path: /misc/lmbraid21/jesslen/NeMo/data/PASCAL3D+_release1.1/CAD_single/{:s}/01.off
  name: nemo
  num_noise: 5
  training:
    T: 0.07
    distance_thr: 48
    loss_reg_weight: 0.1
    optimizer:
      class_name: torch.optim.Adam
      lr: 0.0001
      weight_decay: 0.0001
    scheduler:
      class_name: torch.optim.lr_scheduler.StepLR
      gamma: 0.2
      step_size: 40
    separate_bank: False
    train_accumulate: 10
    weight_noise: 0.005
  transforms:
  - class_name: nemo.datasets.pascal3d.Normalize
task: 3d_pose_estimation
training:
  batch_size: 36
  ckpt_interval: 10
  log_interval: 1
  random_seed: 0
  remove_no_bg: 8
  total_epochs: 200
  visualize_training_data: False
  workers: 8
2023-01-17 14:52:07,498 - INFO - Set random seed to 0
2023-01-17 15:07:25,706 - INFO - Number of training images: 11025
/misc/lmbraid21/jesslen/miniconda3/envs/nemo/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/misc/lmbraid21/jesslen/miniconda3/envs/nemo/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2023-01-17 15:08:05,494 - INFO - Start training
/home/jesslen/Documents/Github/NeMo/nemo/models/upsampling_layer.py:38: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  X1 = F.pad(X1, [diffX // 2, diffX - diffX // 2, diffY // 2, diffY - diffY // 2])
/home/jesslen/Documents/Github/NeMo/nemo/models/keypoint_representation_net.py:191: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  keypoints[:, :, 0] // downsample_rate * line_size
/home/jesslen/Documents/Github/NeMo/nemo/models/keypoint_representation_net.py:192: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  + keypoints[:, :, 1] // downsample_rate
Traceback (most recent call last):
  File "/home/jesslen/Documents/Github/NeMo/scripts/train.py", line 94, in <module>
    main()
  File "/home/jesslen/Documents/Github/NeMo/scripts/train.py", line 90, in main
    train(cfg)
  File "/home/jesslen/Documents/Github/NeMo/scripts/train.py", line 67, in train
    model.train(sample)
  File "/home/jesslen/Documents/Github/NeMo/nemo/models/nemo_cls.py", line 223, in train
    zeros=torch.zeros(img.shape[0], max(self.all_num_verts), max(self.all_num_verts) * len(CATEGORIES), dtype=torch.float32).to(get.device),
RuntimeError: CUDA out of memory. Tried to allocate 2.06 GiB (GPU 0; 23.70 GiB total capacity; 20.32 GiB already allocated; 734.56 MiB free; 21.38 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
End time: Di 17. Jan 15:09:41 CET 2023
